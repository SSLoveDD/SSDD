<!DOCTYPE html>
<html>
	<!--需要修改的地方：
3，搜索历史记录光标移动或按上下键有反应。
4,个人主页信息框小三角。
-->

	<head>
		<meta charset="UTF-8">
		<title>明矾 前端博客 首页</title>
		<link rel="stylesheet" href="index1.5.css" />
	</head>

	<body>
		<a href="javascript:;" id="btn" title="回到顶部"></a><!--若a链接中href为#，则每次点击就会跳回顶部-->
		<div class="alum">
			<a class="avatar" href="showwebsite.html">
				<img class="alumm" src="images/11.png" />
			</a>
			<span class="avatar-alum">个人主页</span>
		</div>
		<div class="banseo">
			<input type="text" class="bantxt" placeholder="搜索文章">
			<button class="btn" type="button"><i class="imooc-icon">&#xe986;</i></button>
			<!-- <input type="text" class="bantxtt" placeholder="搜索文章">-->
			<div class="hisrecord"></div>
		</div>
		<div class="hisrecord"></div>
		<div class="container">
			<a class="nzz">
				<span class="sort">
	    			<i class="imooc-icon">&#xe905;</i>
	    			CSS&nbsp;
	    			<i class="imooc-icon"></i>
	    		</span>
			</a>

			|

			<a class="nzz">
				<span class="sort">
	    			<i class="imooc-icon">
	    				&#xe955;
	    			</i>
	    			JS &nbsp;
	    			<i class="fa"></i>
	    		</span>
			</a>

			|

			<a class="nzz">
				<span class="sort">
	    			<i class="imooc-icon">
	    				&#xe913;
	    			</i>
	    			产品 &nbsp;
	    			<i class="fa"></i>
	    		</span>
			</a>
			|
			<a class="nzz">
				<span class="sort">
	    			<i class="imooc-icon">
	    				&#xe949;
	    			</i>
	    			随笔&nbsp;
	    			<i class="fa"></i>
	    		</span>
			</a>
			|

			<div class="detail">
				<ul class="nn">
					<li>
						<a class="title" href="content1.3.html">你这样写作！真没什么意思！</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;世间事·我最喜欢的环卫工人寒风裹挟着枯黄的梧桐落叶在空中盘旋飞舞，像是一群张牙舞爪的小鬼在人间肆意袭击着路人。这种鬼天气对环卫工王霞来说注定是一场灾难，她……</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>

					</li>
					<li>
						<a class="title">究竟是什么挡住了普通人的逆袭道路？！</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;上月，阶层固化话题爆发。 连锁效应。直接导致了近期打破阶层的话题爆发。但看了很多励志文章，最让我觉得接近现实的，只有雾满拦江老师的一段话： 如果你渴望改变命运，冲破现有阶层的...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
					<li>
						<a class="title">20多岁，看对书比看书多要划算的多</a>　　<span class="subtime">2017.03.03</span>
						<p class="maincon">&nbsp;&nbsp;看书是人类学习最基础的一种方式，只要识字任何一个年龄段的人，都可以捧起一本书进行阅读。在当今这个知识的年代，懂得多自然是自己的一种资本，当然对于年轻的我们而言，看书也要有所选...</p>
						<p class="meta">浏览500次 评论45次 赞 50次 </p>
					</li>
				</ul>
			</div>
			<div class="detail">
				<ul class="nn">
					<li>
						<a>文章11</a>
					</li>
					<li>
						<a>文章12</a>
					</li>
					<li>
						<a>文章13</a>
					</li>
				</ul>
			</div>
			<div class="detail">
				<ul class="nn">
					<li>
						<a>文章111</a>
					</li>
					<li>
						<a>文章121</a>
					</li>
					<li>
						<a>文章131</a>
					</li>
				</ul>
			</div>
			<div class="detail">
				<ul class="nn">
					<li>
						<a>文章1111</a>
					</li>
					<li>
						<a>文章1211</a>
					</li>
					<li>
						<a>文章1311</a>
					</li>
				</ul>
			</div>
		</div>
		<ul class="butt">
			<li class="left ffborder"></li>
			<li class="right ffborder"></li>
		</ul>

		<script>
			debugger;
			window.localStorage.clear();
			var nzz = getByClass('nzz');
			var nn = getByClass('nn');
			var detail = getByClass('detail');
			var nav = getByClass('nav')[0];
			var hisrecord = getByClass('hisrecord')[0];
			var bantxtt = getByClass('bantxtt')[0];
			var bantxt = getByClass('bantxt')[0];
			var btn = getByClass('btn')[0];
			localStorage.setItem('2017-3-16  21:33:36', '匡佳青0');
			localStorage.setItem('2017-3-16  21:34:36', '匡佳青1');
			localStorage.setItem('2017-3-16  21:35:36', '匡佳青2');
			localStorage.setItem('2017-3-16  21:36:36', '匡佳青3');
			localStorage.setItem('2017-3-16  21:37:36', '匡佳青4');
			myAddEvent(bantxt, 'focus', function() {
				init();
				for(var i = localStorage.length - 1; i >= 0; i--) {
					newdiv = document.createElement("div");
					newdiv.innerHTML = localStorage.getItem(localStorage.key(i))
					hisrecord.appendChild(newdiv);
				}
				hisrecord.style.display = "block";
			})
			myAddEvent(bantxt, 'blur', function() {
					hisrecord.style.display = "none";
				})
				//必须按照时间排，用数组命名不可以。因为字典式的
			myAddEvent(btn, 'click', function() {
					curvalue = bantxt.value;
					if(curvalue == "") {
						alert("并没有输入内容");
					} else {
						curtime = getCurrentTime();
						init();
						saveValue(curtime, curvalue);
						bantxt.value = "";
					}
				})
				//保存localstorage中不存在的value时，点击搜索按钮时将搜索内容value存入localStorage.
			function saveNoexistSearch(curtime, value) {
				if(localStorage.length >= 5) {
					while(localStorage.length >= 5) {
						localStorage.removeItem(localStorage.key(0));
					}
					localStorage.setItem(curtime, value);
				} else {
					localStorage.setItem(curtime, value);
				}
			}
			//保存已经存在的value进入localstorage中
			function saveExistValue(curtime, value) {
				for(var i = 0; i < localStorage.length; i++) {
					if(value === localStorage.getItem(localStorage.key(i))) {
						localStorage.removeItem(localStorage.key(i));
					}
				}
				localStorage.setItem(curtime, value);
			}
			//判断数组arr中是否存在x。
			function existitem(x, arr) {
				flag = false;
				for(var i = 0; i < arr.length; i++) {
					if(x === arr[i]) {
						flag = true;
						break;
					}
				}
				return flag;
			}
			//保存value进入localstorage。上面两个函数联合
			function saveValue(curtime, value) {
				flagg = existitem(value, hisItem);
				if(flagg) { //判断value是否在hisItem数组中????这里有问题
					saveExistValue(curtime, value);
				} else {
					saveNoexistSearch(curtime, value);
				}
			}
			//获取localstorage中已有的value数组
			function getValueArr() {
				for(var i = 0; i < localStorage.length; i++) {
					//if (!isNaN(localStorage.key(i))) {//这句之所以删掉是因为时间格式好像用不了
					hisItem.push(localStorage.getItem(localStorage.key(i)));
					//}
				}
				return hisItem;
			}
			//init
			function init() {
				hisItem = [];
				hisItem = getValueArr();
				hisrecord.innerHTML = "";

			}

			function getCurrentTime() {
				var today = new Date();
				var y = today.getFullYear();
				var mh = today.getMonth();
				mh++;
				var d = today.getDate();
				var h = today.getHours();
				var m = today.getMinutes();
				var s = today.getSeconds();
				m = checkTime(m)
				s = checkTime(s)
				var time = y + "-" + mh + "-" + d + "  " + h + ":" + m + ":" + s;
				return time;
			}

			function checkTime(i) {
				if(i < 10)
					i = "0" + i
				return i
			}
			//添加有兼容性问题
			function myAddEvent(obj, evName, fn) { //evName只能等于mouseover或mouseout?。ie下也有mouseout？
				//fn是一个匿名函数，里面可以是匿名函数中包含下面自定义的hover函数
				if(obj.attachEvent) { //IE
					obj.attachEvent('on' + evName, function() {
						fn.call(this); //避免this被修改  这里应该写成fn.call(obj)???
					});
				} else {
					obj.addEventListener(evName, fn, false);
				}
			}
			//document.getElementsByClassName不能支持IE8,返回的aResult仍然是数组，即使用的时候仍然需要下标
			function getByClass(className) {
				var aResult = [];
				var arr = document.getElementsByTagName('*');
				var re = new RegExp('\\b' + className + '\\b', i); //因为className是动态变化的，所以只能用new RegExp的方法
				for(var i = 0; i < arr.length; i++) {
					if(re.test(arr[i].className)) {
						aResult.push(arr[i]);
					}
				};
				return aResult; //这里返回的是指定classname的元素，而非Newjs对象，后面无法连缀。
			}
			detail[1].style.display = "none";
			detail[2].style.display = "none";
			detail[3].style.display = "none";
			//添加class
			function addClass(objs, className) {
				for(var i = 0; i < objs.length; i++) {
					if(!objs[i].className.match(new RegExp('(\\s|^)' + className + '(\\s|$)'))) {
						objs[i].className += ' ' + className;
					}
				}
			}
			//移除class
			function removeClass(objs, className) {
				for(var i = 0; i < objs.length; i++) {
					if(objs[i].className.match(new RegExp('(\\s|^)' + className + '(\\s|$)'))) {
						objs[i].className = objs[i].className.replace(new RegExp('(\\s|^)' + className + '(\\s|$)'), ' ');
					}
				}
			}
//返回顶部
var obtn=document.getElementById("btn");
var timer=null;
var isTop=true;
var clientHeight=document.documentElement.clientHeight;//可视区域的高度
window.onscroll=function(){
osTop=document.body.scrollTop;//滚动条距离顶部距离
if(osTop>=clientHeight){
obtn.style.display="block";
}else{//必须有else下面这几句，不然滑动结束到顶部后仍不会消失。
obtn.style.display="none";
}
if(!isTop){//
clearInterval(timer);}
isTop=false;
}
obtn.onclick=function(){
timer=setInterval(function(){
osTop=document.body.scrollTop;
//后半句用来兼容ie
var ispeed=Math.floor(-osTop/6);//必须是前面有负号的，否则会有错误，一直到达不了顶部，距离顶部始终有5像素
document.documentElement.scrollTop=document.body.scrollTop=osTop+ispeed;
isTop=true;
console.log(osTop-ispeed);
if(osTop==0){
clearInterval(timer);
}
},30);
}
//添加class
			function addClass(objs, className) {
				for(var i = 0; i < objs.length; i++) {
					if(!objs[i].className.match(new RegExp('(\\s|^)' + className + '(\\s|$)'))) {
						objs[i].className += ' ' + className;
					}
				}
			}

			//avata image点击alum的图像显示文字：进入个人主页,即将avatar-alum的display设置为none
			var alumm = getByClass('alumm')[0];
			var avataralum = getByClass('avatar-alum')[0];
			myAddEvent(alumm, 'mouseover', function() {
				avataralum.style.display = "inline-block";
			})
			myAddEvent(alumm, 'mouseout', function() {
				avataralum.style.display = "none";
			})

			for(var i = 0; i < nzz.length; i++) {
				myAddEvent(nzz[i], 'mouseover', function() {
					//alert(this.parentElement.childElementCount);//8
					//_this=this;
					detail[0].style.display = "none";
					detail[1].style.display = "none";
					detail[2].style.display = "none";
					detail[3].style.display = "none";
					this.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.style.display = "block";
				})
			}
		</script>

	</body>

</html>